<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>K-Stock Sim 로그인</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="login-wrap">
    <h2 style="margin-top:0">K-Stock Simulator</h2>
    <p style="color:#9da7b1">미성년자/비계좌 사용자용 한국주식 모의투자</p>
    <div id="msg" class="error" style="display:none"></div>
    <div style="display:grid;gap:8px">
      <input id="username" placeholder="아이디" autocomplete="username">
      <input id="password" placeholder="비밀번호" type="password" autocomplete="current-password">
      <div class="flex" style="justify-content:space-between">
        <button class="btn" onclick="doLogin()">로그인</button>
        <button class="btn secondary" onclick="doRegister()">회원가입</button>
      </div>
    </div>
  </div>
<script>
async function doRegister(){
  const r = await fetch('/api/auth/register',{method:'POST',headers:{'Content-Type':'application/json'},
    body: JSON.stringify({username: username.value, password: password.value})});
  if(r.ok){ location.href='/app.html'; }
  else { const j = await r.json().catch(()=>({msg:'에러'})); showErr(j.msg||'회원가입 실패'); }
}
async function doLogin(){
  const r = await fetch('/api/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},
    body: JSON.stringify({username: username.value, password: password.value})});
  if(r.ok){ location.href='/app.html'; }
  else { showErr('로그인 실패'); }
}
function showErr(t){ const m=document.getElementById('msg'); m.innerText=t; m.style.display='block'; }
</script>
</body>
</html>
